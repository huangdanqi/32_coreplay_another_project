# (三) 写日记Agent (实时)

## 1. 任务
根据玩具当天发生的所有事件,随机写日记。每个事件类型独立的Agent和prompt、入参,出参相同。

## 2. 流程
- 认领事件必写日记
- 每日0:00判断下一日需要写日记的数量:0-5间随机选数字
- 需写日记数量不为0时,在每日发生事件时,随机判定本次事件是否需要写日记,如需写,调用对应的查询函数作为入参,调用对应类型的agent写日记,直至写完当日需要写的数量为止。如当日事件数量不足导致写日记任务未完成,不需要补写。(或者可以从事件类型中随机抽取对应数量的标签,选择今天要写的日记类型)
- 每个类型只写一条日记

## 3. 输入内容

### 3.1 天气类日记
- **触发条件:** 命中喜欢/讨厌的天气后
- **查询数据:** 查询今天完整的天气变化和明天的天气变化
- **包含内容:** 城市、天气变化、IP喜欢的天气、IP讨厌的天气、IP的性格类型

### 3.2 季节类日记
- **触发条件:** 命中喜欢/讨厌的季节后
- **查询数据:** 查询设备IP地址/手机IP地址所在城市的季节和气温
- **包含内容:** 城市、季节、气温、IP喜欢的季节、IP讨厌的季节、IP的性格类型

### 3.3 时事热搜类
- **触发条件:** 命中重大灾难性/利好性事件后
- **包含内容:** 事件名称、事件标签(重大灾难性、重大利好性)

### 3.4 节假日类
- **触发条件:** 在节日前3天到节日后3天的期间内,随机选择1天,然后随机选择一个事件写日记
- **包含内容:** 时间(节前X天/节日第X天/节后X天)、节日名称

### 3.5 远程玩具间互动类有情绪事件
- **触发条件:** 每次触发喜欢/讨厌的远程互动时
- **包含内容:** 密友远程触发的事件名称、密友的昵称、密友主人的昵称、被触发玩具对action的喜好

### 3.6 玩具密友同频事件
- **触发条件:** 每次触发同频事件时
- **包含内容:** 触发同频事件的事件名称、玩具主人昵称、密友的昵称、密友主人的昵称

### 3.7 认领事件
- **触发条件:** 每次绑定设备时
- **包含内容:** 主人的个人资料

### 3.8 人机互动类事件
- **触发条件:** 每次收到MQTT消息,且消息类型为事件时
- **包含内容:** 触发同频事件的事件名称、玩具主人昵称、密友的昵称、密友主人的昵称

### 3.9 人机对话类事件
- **触发条件:** 每次生成一段对话的事件提取结果时
- **包含内容:** 事件summary、事件标题、内容主题、主人的情绪

### 3.10 互动减少类事件
- **触发条件:** 每次触发后,在第二天随机时间写日记
- **包含内容:** 事件名称、断联类型(完全无互动/无对话有互动)、断联天数

## 4. 输出日记内容
- **时间**
- **玩具的情绪标签:** 生气愤怒、悲伤难过、担忧、焦虑忧愁、惊讶震惊、好奇、费解、平静、开心快乐、兴奋激动
- **标题:** 6个字符以内,根据内容生成
- **内容:** 35个字符以内,可以包含emoji
